{"version":3,"file":"index.es.js","sources":["../src/MediaEmbedElement/MediaEmbedElement.styles.ts","../src/MediaEmbedElement/MediaEmbedUrlInput.tsx","../src/MediaEmbedElement/MediaEmbedElement.tsx","../src/MediaEmbedToolbarButton/MediaEmbedToolbarButton.tsx"],"sourcesContent":["import { createStyles } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\nimport tw from 'twin.macro';\nimport { MediaEmbedElementProps } from './MediaEmbedElement.types';\n\nexport const getMediaEmbedElementStyles = (props: MediaEmbedElementProps) =>\n  createStyles(\n    { prefixClassNames: 'MediaEmbedElement', ...props },\n    {\n      root: tw`relative`,\n      iframeWrapper: [tw`relative`, tw`padding[75% 0 0 0]`],\n      iframe: [tw`absolute top-0 left-0 w-full h-full`],\n      input: [\n        tw`w-full`,\n        css`\n          padding: 0.5em;\n          font-size: 0.85em;\n          border: 2px solid #ddd;\n          background: #fafafa;\n          margin-top: 5px;\n        `,\n      ],\n    }\n  );\n","import React from 'react';\nimport { CSSProp } from 'styled-components';\n\nexport const MediaEmbedUrlInput = ({\n  url,\n  onChange,\n  ...props\n}: {\n  className?: string;\n  css?: CSSProp;\n  url: string;\n  onChange: Function;\n}) => {\n  const [value, setValue] = React.useState(url);\n\n  const validateUrl = (newUrl: string) => {\n    // if not starting with http, assume pasting of full iframe embed code\n    if (newUrl.substring(0, 4) !== 'http') {\n      const regexMatchSrc = /src=\".*?\"/;\n      const regexGroupQuotes = /\"([^\"]*)\"/;\n\n      const src = newUrl.match(regexMatchSrc)?.[0];\n      const returnString = src?.match(regexGroupQuotes)?.[1];\n\n      if (returnString) {\n        newUrl = returnString;\n      }\n    }\n    return newUrl;\n  };\n\n  return (\n    <input\n      value={value}\n      onClick={(e) => e.stopPropagation()}\n      onChange={(e) => {\n        const newUrl = e.target.value;\n        validateUrl(newUrl);\n        setValue(newUrl);\n        onChange(newUrl);\n      }}\n      {...props}\n    />\n  );\n};\n","import React from 'react';\nimport { setNodes, TElement } from '@udecode/plate-core';\nimport { MediaEmbedNodeData } from '@udecode/plate-media-embed';\nimport { getRootProps } from '@udecode/plate-styled-components';\nimport { ReactEditor } from 'slate-react';\nimport { getMediaEmbedElementStyles } from './MediaEmbedElement.styles';\nimport { MediaEmbedElementProps } from './MediaEmbedElement.types';\nimport { MediaEmbedUrlInput } from './MediaEmbedUrlInput';\n\nexport const MediaEmbedElement = (props: MediaEmbedElementProps) => {\n  const { attributes, children, nodeProps, element, editor } = props;\n\n  const rootProps = getRootProps(props);\n\n  const { url } = element;\n  const querySeparator = url.includes('?') ? '' : '?';\n\n  const styles = getMediaEmbedElementStyles(props);\n\n  return (\n    <div\n      {...attributes}\n      css={styles.root.css}\n      className={styles.root.className}\n      {...rootProps}\n    >\n      <div contentEditable={false}>\n        <div\n          css={styles.iframeWrapper?.css}\n          className={styles.iframeWrapper?.className}\n        >\n          <iframe\n            css={styles.iframe?.css}\n            className={styles.iframe?.className}\n            title=\"embed\"\n            src={`${url}${querySeparator}&title=0&byline=0&portrait=0`}\n            frameBorder=\"0\"\n            {...nodeProps}\n          />\n        </div>\n\n        <MediaEmbedUrlInput\n          data-testid=\"MediaEmbedUrlInput\"\n          css={styles.input?.css}\n          className={styles.input?.className}\n          url={url}\n          onChange={(val: string) => {\n            const path = ReactEditor.findPath(editor, element);\n            setNodes<TElement<MediaEmbedNodeData>>(\n              editor,\n              { url: val },\n              { at: path }\n            );\n          }}\n        />\n      </div>\n      {children}\n    </div>\n  );\n};\n","import React from 'react';\nimport { usePlateEditorRef } from '@udecode/plate-core';\nimport { insertMediaEmbed } from '@udecode/plate-media-embed';\nimport { ToolbarButton, ToolbarButtonProps } from '@udecode/plate-toolbar';\n\nexport interface MediaEmbedToolbarButtonProps extends ToolbarButtonProps {\n  /**\n   * Default onMouseDown is getting the embed url by calling this promise before inserting the embed.\n   */\n  getEmbedUrl?: () => Promise<string>;\n}\n\nexport const MediaEmbedToolbarButton = ({\n  getEmbedUrl,\n  ...props\n}: MediaEmbedToolbarButtonProps) => {\n  const editor = usePlateEditorRef()!;\n\n  return (\n    <ToolbarButton\n      onMouseDown={async (event) => {\n        if (!editor) return;\n\n        event.preventDefault();\n\n        let url;\n        if (getEmbedUrl) {\n          url = await getEmbedUrl();\n        } else {\n          url = window.prompt('Enter the URL of the embed:');\n        }\n        if (!url) return;\n\n        insertMediaEmbed(editor, { url });\n      }}\n      {...props}\n    />\n  );\n};\n"],"names":["getMediaEmbedElementStyles","props","createStyles","prefixClassNames","root","iframeWrapper","iframe","input","css","MediaEmbedUrlInput","url","onChange","value","setValue","React","useState","validateUrl","newUrl","substring","regexMatchSrc","regexGroupQuotes","src","match","returnString","e","stopPropagation","target","MediaEmbedElement","attributes","children","nodeProps","element","editor","rootProps","getRootProps","querySeparator","includes","styles","className","val","path","ReactEditor","findPath","setNodes","at","MediaEmbedToolbarButton","getEmbedUrl","usePlateEditorRef","event","preventDefault","window","prompt","insertMediaEmbed"],"mappings":"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"}