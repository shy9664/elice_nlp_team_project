{"ast":null,"code":"import { isCollapsed, queryNode, createPluginFactory } from '@udecode/plate-core';\nimport { Editor, Transforms } from 'slate';\n/**\n * Set a list of element types to select on backspace\n */\n\nconst withSelectOnBackspace = (editor, {\n  options: {\n    query\n  }\n}) => {\n  const {\n    deleteBackward\n  } = editor;\n\n  editor.deleteBackward = unit => {\n    const {\n      selection\n    } = editor;\n\n    if (unit === 'character' && isCollapsed(selection)) {\n      const prevNode = Editor.before(editor, selection, {\n        unit\n      });\n\n      if (prevNode) {\n        const [prevCell] = Editor.nodes(editor, {\n          match: node => queryNode([node, prevNode.path], query),\n          at: prevNode\n        });\n\n        if (!!prevCell && prevNode) {\n          // don't delete image, set selection there\n          Transforms.select(editor, prevNode);\n        } else {\n          deleteBackward(unit);\n        }\n      } else {\n        deleteBackward(unit);\n      }\n    } else {\n      deleteBackward(unit);\n    }\n  };\n\n  return editor;\n};\n\nconst KEY_SELECT_ON_BACKSPACE = 'selectOnBackspace';\n/**\n * @see {@link withSelectOnBackspace}\n */\n\nconst createSelectOnBackspacePlugin = createPluginFactory({\n  key: KEY_SELECT_ON_BACKSPACE,\n  withOverrides: withSelectOnBackspace\n});\nexport { KEY_SELECT_ON_BACKSPACE, createSelectOnBackspacePlugin, withSelectOnBackspace };","map":{"version":3,"sources":["../src/withSelectOnBackspace.ts","../src/createSelectOnBackspacePlugin.ts"],"names":["withSelectOnBackspace","options","query","deleteBackward","editor","unit","selection","isCollapsed","prevNode","match","node","queryNode","at","Transforms","KEY_SELECT_ON_BACKSPACE","createSelectOnBackspacePlugin","createPluginFactory","key","withOverrides"],"mappings":";;AASA;AACA;AACA;;MACaA,qBAGZ,GAAG,CAAA,MAAA,EAAS;AAAEC,EAAAA,OAAO,EAAE;AAAEC,IAAAA;AAAF;AAAX,CAAT,KAAoC;AACtC,QAAM;AAAEC,IAAAA;AAAF,MAAN,MAAA;;AAEAC,EAAAA,MAAM,CAANA,cAAAA,GAAyBC,IAAD,IAAmD;AACzE,UAAM;AAAEC,MAAAA;AAAF,QAAN,MAAA;;AACA,QAAID,IAAI,KAAJA,WAAAA,IAAwBE,WAAW,CAAvC,SAAuC,CAAvC,EAAoD;AAClD,YAAMC,QAAQ,GAAG,MAAM,CAAN,MAAA,CAAA,MAAA,EAAA,SAAA,EAAmD;AAClEH,QAAAA;AADkE,OAAnD,CAAjB;;AAGA,UAAA,QAAA,EAAc;AACZ,cAAM,CAAA,QAAA,IAAa,MAAM,CAAN,KAAA,CAAA,MAAA,EAA4B;AAC7CI,UAAAA,KAAK,EAAGC,IAAD,IAAUC,SAAS,CAAC,CAAA,IAAA,EAAgBH,QAAQ,CAAzB,IAAC,CAAD,EADmB,KACnB,CADmB;AAE7CI,UAAAA,EAAE,EAAEJ;AAFyC,SAA5B,CAAnB;;AAKA,YAAI,CAAC,CAAD,QAAA,IAAJ,QAAA,EAA4B;AAC1B;AACAK,UAAAA,UAAU,CAAVA,MAAAA,CAAAA,MAAAA,EAAAA,QAAAA;AAFF,SAAA,MAGO;AACLV,UAAAA,cAAc,CAAdA,IAAc,CAAdA;AACD;AAXH,OAAA,MAYO;AACLA,QAAAA,cAAc,CAAdA,IAAc,CAAdA;AACD;AAlBH,KAAA,MAmBO;AACLA,MAAAA,cAAc,CAAdA,IAAc,CAAdA;AACD;AAvBHC,GAAAA;;AA0BA,SAAA,MAAA;AACD,C;;MCtCYU,uBAAuB,GAAG,mB;AAEvC;AACA;AACA;;MACaC,6BAA6B,GAAGC,mBAAmB,CAC9D;AACEC,EAAAA,GAAG,EADL,uBAAA;AAEEC,EAAAA,aAAa,EAAElB;AAFjB,CAD8D,C","sourcesContent":["import {\n  isCollapsed,\n  queryNode,\n  TNode,\n  WithOverride,\n} from '@udecode/plate-core';\nimport Slate, { Editor, Transforms } from 'slate';\nimport { SelectOnBackspacePlugin } from './createSelectOnBackspacePlugin';\n\n/**\n * Set a list of element types to select on backspace\n */\nexport const withSelectOnBackspace: WithOverride<\n  {},\n  SelectOnBackspacePlugin\n> = (editor, { options: { query } }) => {\n  const { deleteBackward } = editor;\n\n  editor.deleteBackward = (unit: 'character' | 'word' | 'line' | 'block') => {\n    const { selection } = editor;\n    if (unit === 'character' && isCollapsed(selection)) {\n      const prevNode = Editor.before(editor, selection as Slate.Location, {\n        unit,\n      });\n      if (prevNode) {\n        const [prevCell] = Editor.nodes<TNode>(editor, {\n          match: (node) => queryNode([node as TNode, prevNode.path], query),\n          at: prevNode,\n        });\n\n        if (!!prevCell && prevNode) {\n          // don't delete image, set selection there\n          Transforms.select(editor, prevNode);\n        } else {\n          deleteBackward(unit);\n        }\n      } else {\n        deleteBackward(unit);\n      }\n    } else {\n      deleteBackward(unit);\n    }\n  };\n\n  return editor;\n};\n","import { createPluginFactory, QueryNodeOptions } from '@udecode/plate-core';\nimport { withSelectOnBackspace } from './withSelectOnBackspace';\n\nexport type SelectOnBackspacePlugin = {\n  query?: QueryNodeOptions;\n};\n\nexport const KEY_SELECT_ON_BACKSPACE = 'selectOnBackspace';\n\n/**\n * @see {@link withSelectOnBackspace}\n */\nexport const createSelectOnBackspacePlugin = createPluginFactory<SelectOnBackspacePlugin>(\n  {\n    key: KEY_SELECT_ON_BACKSPACE,\n    withOverrides: withSelectOnBackspace,\n  }\n);\n"]},"metadata":{},"sourceType":"module"}